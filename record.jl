hardware_tags = [
    :CPU,
    :Memory,
]

os_tags = [
    :Lock,
    :Socket,
    :Thread,
    :Page,
    :Atomic,
    :Policy,
    :FileMeta
]

software_tags = [
    :ThreadPool,
    :Data,
]

# The rule of writing in
# Used it ?
cves = Dict(
  "2020-7463"  => [[:Memory], [:Lock :Socket :Thread :Page]],
  "2023-52079" => [[:CPU], [:Thread]],
  "2023-27537" => [[:Memory], [:Page]],
  "2023-20897" => [[:CPU], [:Thread :Socket]],
  "2022-48434" => [[:Memory], [:Thread :Page]],
  "2022-35922" => [[:Memory], [:Socket :Page]],
  "2022-23639" => [[], [:Atomic]],
  "2022-21732" => [[], [:Thread], [:ThreadPool]],
  "2022-1097"  => [[:Memory], [:Thread :Page]],
  "2020-15681" => [[:Memory], [:Thread :Page]], # Wasm Thead, still can be seen as OS Thread
  "2019-18683" => [[:Memory], [:Lock :Thread :Page]],
  "2019-17638" => [[:Memory], [:Thread :Socket]],
  "2018-25026" => [[:Memory], [:Thread :Page]],
  "2017-9687"  => [[:Memory], [:Thread :Page]],
  "2017-9677"  => [[:Memory], [:Thread :Page]],
  "2017-8244"  => [[:Memory], [:Thread]],
  "2017-5392"  => [[:Memory], [:Thread :Page]],
  "2017-20004" => [[], [:Lock], [:Data]],
  "2023-6546"  => [[:Memory], [:Page :Thread]],
  # Denial of service
  "2017-18193" => [[:Memory], [:Page :Thread]],
  "2017-11023" => [[:Memory], [:Page :Thread]],
  "2022-31623" => [[], [:Lock :Thread], []],
  "2022-29503" => [[:Memory], [:Page :Thread]],
  "2021-3975"  => [[:Memory], [:Thread, :Page]],
  "2021-29509" => [[:Memory], [:Socket], [:ThreadPool]],
  "2020-35510" => [[:CPU], [:Thread]],
  "2020-13128" => [[], [:Thread]],
  "2019-3894"  => [[], [:Thread]],
  "2019-3883"  => [[], [:Thread :Socket], [:ThreadPool]],
  "2019-16770" => [[], [:Thread :Socket]],
  "2019-10072" => [[:CPU], [:Thread :Socket]],
  "2018-15746" => [[], [:Thread :Policy]],
  "2018-0004"  => [[:CPU], [:Thread]],
  "2017-5650"  => [[], [:Thread]],
  "2017-18249" => [[:Memory], [:Thread :Page]],
  "2017-15826" => [[:Memory], [:Thread :Page]],
  "2017-13197" => [[], [:Thread]],
  "2016-2428"  => [[:Memory], [:Thread :Page]],
  "2015-8661"  => [[], [:Thread]],
  "2014-3880"  => [[:Memory], [:Thread :Page]],
  "2014-3174"  => [[:Memory], [:Thead :Page]],
  "2013-0907"  => [[], [:Thread :Page]],
  "2011-1486"  => [[], [:Thread]],
  "2005-3106"  => [[:Memory], [:Thread :Lock]],
  "2005-0001"  => [[:Memory], [:Thread :Page]],
  "2004-0837"  => [[], [:Thread]],
  "2003-0189"  => [[], [:Thread]],
  "2000-0369"  => [[], [:Thread]],
  "2020-10577" => [[], [:Thread], [:Data]],
  "2016-8623"  => [[], [:Thread], [:Data]],
  "2016-8605"  => [[], [:Thread :FileMeta]],
  "2014-2667"  => [[], [:Thread :FileMeta]],
  "2008-0299"  => [[], [:Thread]],
)

print(
  cves 
    |> values 
    .|> length 
    |> arr -> filter(v -> v > 0, arr) 
    |> length
)
